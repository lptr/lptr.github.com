<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>A new beginning | Redneck Overengineering</title>
<meta name=keywords content>
<meta name=description content="Looks like every ten years I attempt to write a blog. This time around it seems that I actually have something to say, so let&rsquo;s see what happens. :)
 Flow alert device   Above is a flow sensor I am currently building for our family farm. It&rsquo;s the second IoT device to be installed there, and its role will be to warn us whenever the irrigation system develops another leak.">
<meta name=author content="Lóránt Pintér">
<link rel=canonical href=https://lptr.github.io/posts/a-new-beginning/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.6f60056d44d3f7eb69a4bc6c332b59960f3a995802bded244750232f33713c49.css integrity="sha256-b2AFbUTT9+tppLxsMytZlg86mVgCve0kR1AjLzNxPEk=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://lptr.github.io/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://lptr.github.io/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://lptr.github.io/favicon-32x32.png>
<link rel=apple-touch-icon href=https://lptr.github.io/apple-touch-icon.png>
<link rel=mask-icon href=https://lptr.github.io/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.89.0">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-25254661-1','auto'),ga('send','pageview'))</script><meta property="og:title" content="A new beginning">
<meta property="og:description" content="Looks like every ten years I attempt to write a blog. This time around it seems that I actually have something to say, so let&rsquo;s see what happens. :)
 Flow alert device   Above is a flow sensor I am currently building for our family farm. It&rsquo;s the second IoT device to be installed there, and its role will be to warn us whenever the irrigation system develops another leak.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://lptr.github.io/posts/a-new-beginning/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2021-11-01T16:18:59+01:00">
<meta property="article:modified_time" content="2021-11-01T16:18:59+01:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="A new beginning">
<meta name=twitter:description content="Looks like every ten years I attempt to write a blog. This time around it seems that I actually have something to say, so let&rsquo;s see what happens. :)
 Flow alert device   Above is a flow sensor I am currently building for our family farm. It&rsquo;s the second IoT device to be installed there, and its role will be to warn us whenever the irrigation system develops another leak.">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"","item":"https://lptr.github.io/posts/"},{"@type":"ListItem","position":2,"name":"A new beginning","item":"https://lptr.github.io/posts/a-new-beginning/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"A new beginning","name":"A new beginning","description":"Looks like every ten years I attempt to write a blog. This time around it seems that I actually have something to say, so let\u0026rsquo;s see what happens. :)\n Flow alert device   Above is a flow sensor I am currently building for our family farm. It\u0026rsquo;s the second IoT device to be installed there, and its role will be to warn us whenever the irrigation system develops another leak.","keywords":[],"articleBody":"Looks like every ten years I attempt to write a blog. This time around it seems that I actually have something to say, so let’s see what happens. :)\n Flow alert device   Above is a flow sensor I am currently building for our family farm. It’s the second IoT device to be installed there, and its role will be to warn us whenever the irrigation system develops another leak. The device uses a ton of technologies I haven’t even heard of 18 months ago when all of this started. Many things worked out really well since then, and it took help from many people. Below is a recounting of the trip so far, to serve as introduction for the next chapters.\nThe printer As so many things recently, this all started with Covid. When the virus hit, I wanted to help. I saw an article on the web about people 3D printing “ear savers” for people doctors wearing masks all day, and even holders for plexiglass shields, when there weren’t enough surgical masks around in the beginning. This sounded like a great idea, and I wanted to join.\nAfter consulting with a colleague at work who had prior experience, I got myself a Prusa MK3S. And because of this colleague’s advice, I did not get the pre-assembled printer, but ordered a kit to be put together by myself. While I never managed to help doctors with my prints, this turned out to be the beginning of a ton of adventure in both technology and self-discovery.\nYou see, back then I was as far from considering myself a maker, or even a tinkerer, as you could possibly imagine. To demonstrate: I recently got a grill for the garden; the one with the little wheels to move it around. The wheels were secured to the axle with a cotter pin, and I messed up one of them during assembly. I later spent hours in home improvement stores online and offline to find the exact same pin, to no avail. I was convinced that the grill would only function properly with the stock pin. Of course, today I know that any piece of wire would have done the trick, but that realization came after a lot of learning. (That’s not to say I ever actually fixed the wheel, of course.)\nSo when the box with the printer finally arrived last April, I was extremely excited, but also terrified. Here I was, a software developer by trade, who is also proficient at putting together Lego (even Technic!), but I couldn’t imagine myself successfully assembling grown up stuff in the real world. But the Prusa manuals were great, and with a little help from my wife I finished building the printer by 4 AM, and had the first print (a Benchy) ready by 7 AM. I was extremely proud and surprised. And even though the print came out partially broken due to issues with layer adhesion, it was marvelous.\nThis was a turning point in my life: I could imagine, for the first time, that my work can have an immediate effect on the physical reality around me. That I can build stuff. And boy was this just the beginning…\n Speaker mount, one of my first functional designs   Both of my parents are mechanical engineers, and I always looked up to them for their ability to design actual physical objects. My father was an early adopter and an avid fan of AutoCad and Inventor, and I always wanted to design my own stuff like he did. While those tools I could never afford for my hobby, AutoDesk allows just the people like me to use some of their most advanced tools for free as part of the Fusion 360 personal use package. And there are an amazing variety of tutorials to get someone started. So I dove in!\nA light comes on The next piece of the puzzle came as another kit: after printing some parts for his scooter, a friend paid me with an ESP8266 MCU, a breadboard, a blue LED and a single resistor. With that he also kicked me way out of my comfort zone of Java development, and put me on a path of learning and facing a number of my fears around technology.\nThe first of these was electronics: I hated the subject in high school and then at university. It took months to muster up the courage, but eventually I connected the pieces, and uploaded my first self-written firmware. During my career I participated in several big releases, but few could have lived up to the excitement I felt at that single blue light blinking for the first time!\n The first ESP8266   The next major step was to learn C++: a language I haven’t used since university 20 years ago. As someone who jumped on the managed languages bandwagon in 2000 when .NET wasn’t even a beta, and has been working mostly with Java ever since, C++ represented danger and chaos. As one of the lucky coincidences, in my work I also had to do some C++. It was a pleasant surprise to find that C++11 changed the game fundamentally, and for the better. But still, it was an entirely new world with its strange mechanics (what’s a move constructor, again?) and lack of safety rails.\nVisual Studio Code was another revelation. Having used Eclipse and then IntelliJ most of my life I kind of accepted that IDEs are huge, unwieldy beasts by necessity. VSCode proved that wrong, and convinced me that there is a better, lightweight approach to software development. Platform IO made it alost too easy to get started and then become proficient in embedded development.\nLives on the line The first major project where all of this (and more) came together was my chicken door. We have a small family farm a few kilometers away from our home where we started raising chickens (did I mention my wife is also on a learning spree?), and letting them in and out of the coop every day was a chore we decided to do without. But it had to be really-really safe, as we knew from experience that foxes and ferrets were frequently paying visits to our chicken coop.\n Some of our first chickens, named after Hungarian royalty   If you saw the title of this blog, you know I couldn’t just design a simple chicken coop door. It had to be properly overengineered! After several iterations I ended up with using a Bosch aluminum profile for the frame, fishing line and a large aluminum plate for the door itself, an ESP32 board I got from another friend for brains, and several 3D printed parts all designed in Fusion to put the thing together.\n The brains of the chicken door (MK3) sans wiring   One of the things I learned was that hardware design was just as iterative a process as software development was. I first tried my prototype out inside the house, then outside, and finally in the chicken coop itself. But before it could be installed in its production environment, there was a lot of going back to the drawing board, redesigning the 3D parts, soldering and re-soldering connectors, ordering replacement parts for the electronics I messed up with my clumsy soldering, starting yet another new drawing in Fusion titled “MK3” etc.\nThe software backend And the software was no easier! For one, there were completely new challenges, like dealing with the limited resources available on the ESP32 platform. Take for example a seemingly trivial thing, like checking if a given time has passed. This code won’t work:\nif (millis()  previousTimestamp + timeoutInMillis) { // This will not always do what you think it should do } Or more precisely: it would only work for the first fifty-ish days (or the first 2^32 milliseconds). After that, previousTimestamp + timeoutInMillis can roll over, and the condition will trigger immediately. Imagine debugging that in production!\nThe solution? You have to shuffle things around a bit:\nif (millis() - previousTimestamp  timeoutInMillis) { // Do your thing that should happen after the timeout } A subtle difference, but the code works correctly now indefinitely! This is a problem you need to deal with on a 64-bit system only if you are working with time spans across hundreds of millennia, even if your timestamps maintain nanosecond precision.\nMuch of the rest that I learned during my career was also non-applicable in this new environment, or wasn’t as readily available. Take automated testing. On the JVM it is very typical to test the entirety of the codebase. With an application designed to be tested via dependency injection, proper abstractions etc. it is easy to test things, too. Native development, at least the parts I’ve interacted with, seems to be on a very different opinion. It is also much harder to pry your code away from the Arduino framework to keep it testable on its own. But eventually I managed to get the core of the logic testes with GoogleTest. I can’t imagine how else I could sleep well, knowing the complexity of the state machine code that is keeping my chickens safe during the night!\nMentioning that state machine code reminds me that about half of it has been written by Visual Studio Code’s Copilot feature. It is truly astonishing how relevant the suggestions for the AI aer based on so little context. It truly felt like having a second pair of eyes on the code all the time. Meeting copilot was my “AlphaGo Zero moment,” where I got the first taste of what AIs could mean in the future, how immediate that effect will be, and how very soon.\nBut enough of SkyNet for now, let’s go back to chickens!\n Successful user testing   This thing is now operational for a few months without any major problems. The final setup uses a local Raspberry Pi that relays MQTT messages back-and-forth to a server in the cloud. (Did I mention I was always afraid to install my own servers? Well, that’s of the past now, too.) There are graphs tracking motor position and light levels throughout the year using Grafana and InfluxDB. There’s also a dashboard created using NodeRED that allows us to control the door from afar. And all this is running nice and isolated using Docker Compose (yes, even on the Pi).\n NodeRED dashboard on phone   So this is where we are today. I went from a non-maker Java developer to learn stuff about CAD, C++, Arduino, 3D printing, electronics, infrastructure as a service and a ton of other stuff. I am not planning to slow down either, and would like to continue exploring things like subtractive manufacturing (I’d love to build one of those home CNC mills), solar power, robots, image processing and machine learning just to name a few. Check back if you are interested in these continued adventures! :)\n","wordCount":"1821","inLanguage":"en","datePublished":"2021-11-01T16:18:59+01:00","dateModified":"2021-11-01T16:18:59+01:00","author":{"@type":"Person","name":"Lóránt Pintér"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://lptr.github.io/posts/a-new-beginning/"},"publisher":{"@type":"Organization","name":"Redneck Overengineering","logo":{"@type":"ImageObject","url":"https://lptr.github.io/favicon.ico"}}}</script>
</head>
<body id=top>
<script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add('dark'):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove('dark'):window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://lptr.github.io/ accesskey=h title="Redneck Overengineering (Alt + H)">Redneck Overengineering</a>
<span class=logo-switches>
<button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg>
</button>
</span>
</div>
<ul id=menu>
<li>
<a href=https://lptr.github.io/about title=About>
<span>About</span>
</a>
</li>
<li>
<a href=https://lptr.github.io/archives title=Archive>
<span>Archive</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
A new beginning
</h1>
<div class=post-meta><span title="2021-11-01 16:18:59 +0100 +0100">November 1, 2021</span>&nbsp;·&nbsp;9 min&nbsp;·&nbsp;Lóránt Pintér
</div>
</header>
<div class=post-content><p>Looks like every ten years I attempt to write a blog. This time around it seems that I actually have something to say, so let&rsquo;s see what happens. :)</p>
<figure class=align-center>
<img loading=lazy src=flow-alert-photo.jpg#center> <figcaption>
Flow alert device
</figcaption>
</figure>
<p>Above is a flow sensor I am currently building for our family farm. It&rsquo;s the second IoT device to be installed there, and its role will be to warn us whenever the irrigation system develops another leak. The device uses a ton of technologies I haven&rsquo;t even heard of 18 months ago when all of this started. Many things worked out really well since then, and it took help from many people. Below is a recounting of the trip so far, to serve as introduction for the next chapters.</p>
<h2 id=the-printer>The printer<a hidden class=anchor aria-hidden=true href=#the-printer>#</a></h2>
<p>As so many things recently, this all started with Covid. When the virus hit, I wanted to help. I saw an article on the web about people 3D printing &ldquo;ear savers&rdquo; for people doctors wearing masks all day, and even holders for plexiglass shields, when there weren&rsquo;t enough surgical masks around in the beginning. This sounded like a great idea, and I wanted to join.</p>
<p>After consulting with a colleague at work who had prior experience, I got myself a <a href=https://shop.prusa3d.com/en/3d-printers/180-original-prusa-i3-mk3s-kit.html>Prusa MK3S</a>. And because of this colleague&rsquo;s advice, I did not get the pre-assembled printer, but ordered a kit to be put together by myself. While I never managed to help doctors with my prints, this turned out to be the beginning of a ton of adventure in both technology and self-discovery.</p>
<p>You see, back then I was as far from considering myself a maker, or even a tinkerer, as you could possibly imagine. To demonstrate: I recently got a grill for the garden; the one with the little wheels to move it around. The wheels were secured to the axle with a <em>cotter pin,</em> and I messed up one of them during assembly. I later spent <em>hours</em> in home improvement stores online and offline to find the exact same pin, to no avail. I was convinced that the grill would only function properly with the stock pin. Of course, today I know that any piece of wire would have done the trick, but that realization came after a lot of learning. (That&rsquo;s not to say I ever actually fixed the wheel, of course.)</p>
<p>So when the box with the printer finally arrived last April, I was extremely excited, but also terrified. Here I was, a software developer by trade, who is also proficient at putting together Lego (even Technic!), but I couldn&rsquo;t imagine myself successfully assembling <em>grown up stuff</em> in the <em>real world.</em> But the Prusa manuals were great, and with a little help from my wife I finished building the printer by 4 AM, and had the first print (a <a href=https://www.prusaprinters.org/prints/3161-3d-benchy>Benchy</a>) ready by 7 AM. I was extremely proud and surprised. And even though the print came out partially broken due to issues with layer adhesion, it was marvelous.</p>
<p>This was a turning point in my life: I could imagine, for the first time, that my work can have an immediate effect on the physical reality around me. That I can build stuff. And boy was this just the beginning&mldr;</p>
<figure class=align-center>
<img loading=lazy src=speaker-mount.jpg#center> <figcaption>
Speaker mount, one of my first functional designs
</figcaption>
</figure>
<p>Both of my parents are mechanical engineers, and I always looked up to them for their ability to design actual physical objects. My father was an early adopter and an avid fan of AutoCad and Inventor, and I always wanted to design my own stuff like he did. While those tools I could never afford for my hobby, AutoDesk allows just the people like me to use some of their most advanced tools for free as part of the <a href=https://www.autodesk.com/products/fusion-360/personal>Fusion 360 personal use package</a>. And there are an amazing variety of <a href="https://www.youtube.com/watch?v=VbSkwvZyU_0">tutorials to get someone started</a>. So I dove in!</p>
<h2 id=a-light-comes-on>A light comes on<a hidden class=anchor aria-hidden=true href=#a-light-comes-on>#</a></h2>
<p>The next piece of the puzzle came as another kit: after printing some parts for his scooter, a friend paid me with an ESP8266 MCU, a breadboard, a blue LED and a single resistor. With that he also kicked me way out of my comfort zone of Java development, and put me on a path of learning and facing a number of my fears around technology.</p>
<p>The first of these was electronics: I hated the subject in high school and then at university. It took months to muster up the courage, but eventually I connected the pieces, and uploaded my first self-written firmware. During my career I participated in several big releases, but few could have lived up to the excitement I felt at that single blue light blinking for the first time!</p>
<figure class=align-center>
<img loading=lazy src=esp8266.jpg#center> <figcaption>
The first ESP8266
</figcaption>
</figure>
<p>The next major step was to learn C++: a language I haven&rsquo;t used since university 20 years ago. As someone who jumped on the managed languages bandwagon in 2000 when .NET wasn&rsquo;t even a beta, and has been working mostly with Java ever since, C++ represented danger and chaos. As one of the lucky coincidences, in <a href=https://docs.gradle.org/6.7.1/release-notes.html#file-system-watching-is-ready-for-production-use>my work I also had to do some C++</a>. It was a pleasant surprise to find that C++11 changed the game fundamentally, and for the better. But still, it was an entirely new world with its strange mechanics (what&rsquo;s a move constructor, again?) and lack of safety rails.</p>
<p><a href=https://code.visualstudio.com/>Visual Studio Code</a> was another revelation. Having used Eclipse and then IntelliJ most of my life I kind of accepted that IDEs are huge, unwieldy beasts by necessity. VSCode proved that wrong, and convinced me that there is a better, lightweight approach to software development. <a href=https://platformio.org/>Platform IO</a> made it alost too easy to get started and then become proficient in embedded development.</p>
<h2 id=lives-on-the-line>Lives on the line<a hidden class=anchor aria-hidden=true href=#lives-on-the-line>#</a></h2>
<p>The first major project where all of this (and more) came together was my chicken door. We have a small family farm a few kilometers away from our home where we started raising chickens (did I mention my wife is also on a learning spree?), and letting them in and out of the coop every day was a chore we decided to do without. But it had to be really-really safe, as we knew from experience that foxes and ferrets were frequently paying visits to our chicken coop.</p>
<figure class=align-center>
<img loading=lazy src=chickens.jpg#center> <figcaption>
Some of our first chickens, named after Hungarian royalty
</figcaption>
</figure>
<p>If you saw the title of this blog, you know I couldn&rsquo;t just design a <em>simple</em> chicken coop door. It had to be properly overengineered! After several iterations I ended up with using a Bosch aluminum profile for the frame, fishing line and a large aluminum plate for the door itself, an <a href=https://github.com/Xinyuan-LilyGO/LilyGo-T-Call-SIM800>ESP32 board</a> I got from another friend for brains, and several 3D printed parts all designed in Fusion to put the thing together.</p>
<figure class=align-center>
<img loading=lazy src=chicken-door-drawing.png#center> <figcaption>
The brains of the chicken door (MK3) sans wiring
</figcaption>
</figure>
<p>One of the things I learned was that hardware design was just as iterative a process as software development was. I first tried my prototype out inside the house, then outside, and finally in the chicken coop itself. But before it could be installed in its production environment, there was a lot of going back to the drawing board, redesigning the 3D parts, soldering and re-soldering connectors, ordering replacement parts for the electronics I messed up with my clumsy soldering, starting yet another new drawing in Fusion titled &ldquo;MK3&rdquo; etc.</p>
<h2 id=the-software-backend>The software backend<a hidden class=anchor aria-hidden=true href=#the-software-backend>#</a></h2>
<p>And the software was no easier! For one, there were completely new challenges, like dealing with the limited resources available on the ESP32 platform. Take for example a seemingly trivial thing, like checking if a given time has passed. This code won&rsquo;t work:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>if</span> (millis() <span style=color:#f92672>&gt;</span> previousTimestamp <span style=color:#f92672>+</span> timeoutInMillis) {
    <span style=color:#75715e>// This will not always do what you think it should do
</span><span style=color:#75715e></span>}
</code></pre></div><p>Or more precisely: it would only work for the first fifty-ish days (or the first 2^32 milliseconds). After that, <code>previousTimestamp + timeoutInMillis</code> can roll over, and the condition will trigger immediately. Imagine debugging that in production!</p>
<p>The solution? You have to shuffle things around a bit:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#66d9ef>if</span> (millis() <span style=color:#f92672>-</span> previousTimestamp <span style=color:#f92672>&gt;</span> timeoutInMillis) {
    <span style=color:#75715e>// Do your thing that should happen after the timeout
</span><span style=color:#75715e></span>}
</code></pre></div><p>A subtle difference, but the code works correctly now indefinitely! This is a problem you need to deal with on a 64-bit system only if you are working with time spans across hundreds of millennia, even if your timestamps maintain nanosecond precision.</p>
<p>Much of the rest that I learned during my career was also non-applicable in this new environment, or wasn&rsquo;t as readily available. Take automated testing. On the JVM it is very typical to test the entirety of the codebase. With an application designed to be tested via dependency injection, proper abstractions etc. it is easy to test things, too. Native development, at least the parts I&rsquo;ve interacted with, seems to be on a very different opinion. It is also much harder to pry your code away from the Arduino framework to keep it testable on its own. But eventually I managed to get the core of the logic testes with <a href=https://github.com/google/googletest>GoogleTest</a>. I can&rsquo;t imagine how else I could sleep well, knowing the complexity of the <a href=https://github.com/kivancsikert/chicken-coop-door/blob/7700468dc6b997e306b75f8abc70d9919f7bb3b7/lib/door/DoorLogic.cpp#L42-L126>state machine code</a> that is keeping my chickens safe during the night!</p>
<p>Mentioning that state machine code reminds me that about half of it has been written by Visual Studio Code&rsquo;s <a href=https://copilot.github.com/>Copilot feature</a>. It is truly astonishing how <em>relevant</em> the suggestions for the AI aer based on so little context. It truly felt like having a second pair of eyes on the code all the time. Meeting copilot was my &ldquo;<a href=https://en.wikipedia.org/wiki/AlphaGo_Zero>AlphaGo Zero</a> moment,&rdquo; where I got the first taste of what AIs could mean in the future, how immediate that effect will be, and how very soon.</p>
<p>But enough of SkyNet for now, let&rsquo;s go back to chickens!</p>
<figure class=align-center>
<img loading=lazy src=chicken-door.jpg#center> <figcaption>
Successful user testing
</figcaption>
</figure>
<p>This thing is now operational for a few months without any major problems. The final setup uses a local Raspberry Pi that relays MQTT messages back-and-forth to a server in the cloud. (Did I mention I was always afraid to install my own servers? Well, that&rsquo;s of the past now, too.) There are graphs tracking motor position and light levels throughout the year using <a href=https://grafana.com/>Grafana</a> and <a href=https://www.influxdata.com/products/influxdb/>InfluxDB</a>. There&rsquo;s also a dashboard created using <a href=https://nodered.org/>NodeRED</a> that allows us to control the door from afar. And all this is running nice and isolated using <a href=https://docs.docker.com/compose/>Docker Compose</a> (yes, even on the Pi).</p>
<figure class=align-center>
<img loading=lazy src=node-red-dashboard.jpg#center width=50%> <figcaption>
NodeRED dashboard on phone
</figcaption>
</figure>
<p>So this is where we are today. I went from a non-maker Java developer to learn stuff about CAD, C++, Arduino, 3D printing, electronics, infrastructure as a service and a ton of other stuff. I am not planning to slow down either, and would like to continue exploring things like subtractive manufacturing (I&rsquo;d love to build one of those home CNC mills), solar power, robots, image processing and machine learning just to name a few. Check back if you are interested in these continued adventures! :)</p>
</div>
<footer class=post-footer>
</footer><div id=disqus_thread></div>
<script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return}var b=document,a=b.createElement('script');a.async=!0,a.src='//redneck-overengineering.disqus.com/embed.js',a.setAttribute('data-timestamp',+new Date),(b.head||b.body).appendChild(a)})()</script>
<noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript>
<a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a>
</article>
</main>
<footer class=footer>
<span>&copy; 2021 <a href=https://lptr.github.io/>Redneck Overengineering</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove('dark'),localStorage.setItem("pref-theme",'light')):(document.body.classList.add('dark'),localStorage.setItem("pref-theme",'dark'))})</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>